(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["auth"],{"14c3":function(e,t,n){var r=n("c6b6"),o=n("9263");e.exports=function(e,t){var n=e.exec;if("function"===typeof n){var a=n.call(e,t);if("object"!==typeof a)throw TypeError("RegExp exec method returned something other than an Object or null");return a}if("RegExp"!==r(e))throw TypeError("RegExp#exec called on incompatible receiver");return o.call(e,t)}},"33d2":function(e,t,n){"use strict";n("abba")},"466d":function(e,t,n){"use strict";var r=n("d784"),o=n("825a"),a=n("50c4"),s=n("1d80"),i=n("8aa5"),c=n("14c3");r("match",1,(function(e,t,n){return[function(t){var n=s(this),r=void 0==t?void 0:t[e];return void 0!==r?r.call(t,n):new RegExp(t)[e](String(n))},function(e){var r=n(t,e,this);if(r.done)return r.value;var s=o(e),u=String(this);if(!s.global)return c(s,u);var l=s.unicode;s.lastIndex=0;var p,m=[],d=0;while(null!==(p=c(s,u))){var f=String(p[0]);m[d]=f,""===f&&(s.lastIndex=i(u,a(s.lastIndex),l)),d++}return 0===d?null:m}]}))},6547:function(e,t,n){var r=n("a691"),o=n("1d80"),a=function(e){return function(t,n){var a,s,i=String(o(t)),c=r(n),u=i.length;return c<0||c>=u?e?"":void 0:(a=i.charCodeAt(c),a<55296||a>56319||c+1===u||(s=i.charCodeAt(c+1))<56320||s>57343?e?i.charAt(c):a:e?i.slice(c,c+2):s-56320+(a-55296<<10)+65536)}};e.exports={codeAt:a(!1),charAt:a(!0)}},"8aa5":function(e,t,n){"use strict";var r=n("6547").charAt;e.exports=function(e,t,n){return t+(n?r(e,t).length:1)}},9263:function(e,t,n){"use strict";var r=n("ad6d"),o=n("9f7f"),a=RegExp.prototype.exec,s=String.prototype.replace,i=a,c=function(){var e=/a/,t=/b*/g;return a.call(e,"a"),a.call(t,"a"),0!==e.lastIndex||0!==t.lastIndex}(),u=o.UNSUPPORTED_Y||o.BROKEN_CARET,l=void 0!==/()??/.exec("")[1],p=c||l||u;p&&(i=function(e){var t,n,o,i,p=this,m=u&&p.sticky,d=r.call(p),f=p.source,g=0,h=e;return m&&(d=d.replace("y",""),-1===d.indexOf("g")&&(d+="g"),h=String(e).slice(p.lastIndex),p.lastIndex>0&&(!p.multiline||p.multiline&&"\n"!==e[p.lastIndex-1])&&(f="(?: "+f+")",h=" "+h,g++),n=new RegExp("^(?:"+f+")",d)),l&&(n=new RegExp("^"+f+"$(?!\\s)",d)),c&&(t=p.lastIndex),o=a.call(m?n:p,h),m?o?(o.input=o.input.slice(g),o[0]=o[0].slice(g),o.index=p.lastIndex,p.lastIndex+=o[0].length):p.lastIndex=0:c&&o&&(p.lastIndex=p.global?o.index+o[0].length:t),l&&o&&o.length>1&&s.call(o[0],n,(function(){for(i=1;i<arguments.length-2;i++)void 0===arguments[i]&&(o[i]=void 0)})),o}),e.exports=i},"9f7f":function(e,t,n){"use strict";var r=n("d039");function o(e,t){return RegExp(e,t)}t.UNSUPPORTED_Y=r((function(){var e=o("a","y");return e.lastIndex=2,null!=e.exec("abcd")})),t.BROKEN_CARET=r((function(){var e=o("^r","gy");return e.lastIndex=2,null!=e.exec("str")}))},a5ef:function(e,t,n){"use strict";n.r(t);n("b0c0");var r=n("7a23"),o=Object(r["I"])("data-v-58c57db6");Object(r["t"])("data-v-58c57db6");var a={class:"popUp"},s={class:"popUp__window"},i=Object(r["g"])("div",null,null,-1),c=Object(r["g"])("div",null,null,-1),u={class:"popUp__login-logout popUp__parts"},l={key:0},p=Object(r["g"])("h2",null,"LogIn",-1),m=Object(r["g"])("input",{class:"popUp__submit mainButton mainButton--blue",type:"submit",value:"LogIn"},null,-1),d={key:1,class:"popUp__userProfile"},f={class:"mainImg popUp__img"},g={class:"popUp__username"},h=Object(r["g"])("input",{class:"mainButton mainButton--blue popUp__submit",type:"submit",value:"Send changes"},null,-1),b=Object(r["g"])("input",{class:"popUp__submit mainButton mainButton--red",type:"submit",value:"LogOut"},null,-1),O={key:0,class:"popUp__registration popUp__parts"},v=Object(r["g"])("h2",null,"Registration",-1),_=Object(r["g"])("input",{class:"popUp__submit mainButton mainButton--blue",type:"submit",value:"Register"},null,-1);Object(r["r"])();var w=o((function(e,t,n,o,w,j){var x=Object(r["x"])("FileInput");return Object(r["q"])(),Object(r["d"])("div",a,[Object(r["g"])("div",s,[Object(r["g"])("div",{onClick:t[1]||(t[1]=function(){return j.hidePopUp.apply(j,arguments)}),class:"popUp__close"},[i,c]),Object(r["g"])("div",u,[e.authorizedUser?(Object(r["q"])(),Object(r["d"])("div",d,[Object(r["g"])("form",{class:"popUp__changes",onSubmit:t[10]||(t[10]=Object(r["H"])((function(){return j.validateChanges.apply(j,arguments)}),["prevent"])),method:"POST"},[Object(r["g"])("div",f,[Object(r["g"])("img",{src:w.BACKEND_DOMAIN+j.authorizedUserObj.photo},null,8,["src"])]),Object(r["g"])("span",g,Object(r["z"])(e.authorizedUser),1),Object(r["g"])(x),Object(r["g"])("label",{class:["popUp__label",{"popUp__label--invalid":w.formProfile.emptyName||w.formProfile.nameExist||w.formProfile.nameLenMin||w.formProfile.nameLenMax}],for:"newUsername"},null,2),Object(r["F"])(Object(r["g"])("input",{"onUpdate:modelValue":t[8]||(t[8]=function(e){return w.formProfile.name=e}),onInput:t[9]||(t[9]=function(){w.formProfile.emptyName=!1,w.formProfile.nameLenMin=!1,w.formProfile.nameLenMax=!1,w.formProfile.nameExist=!1}),class:"mainInput popUp__input",type:"text",name:"newUsername"},null,544),[[r["B"],w.formProfile.name,void 0,{trim:!0}]]),Object(r["g"])("span",null,Object(r["z"])(w.formProfile.emptyName?"Enter a name":w.formProfile.nameLenMin?"At least 3 characters":w.formProfile.nameLenMax?"To long name":w.formProfile.nameExist?"Already exist":""),1),h],32),Object(r["g"])("form",{class:"popUp__logOut",onSubmit:t[11]||(t[11]=Object(r["H"])((function(){return j.logOut.apply(j,arguments)}),["prevent"])),method:"POST"},[b],32)])):(Object(r["q"])(),Object(r["d"])("div",l,[p,Object(r["g"])("form",{onSubmit:t[7]||(t[7]=Object(r["H"])((function(){return j.validatelogIn.apply(j,arguments)}),["prevent"])),action:"",method:"GET"},[Object(r["g"])("label",{class:["popUp__label",{"popUp__label--invalid":w.formLog.emptyName||w.formLog.noSuchName}],for:"name"},null,2),Object(r["F"])(Object(r["g"])("input",{"onUpdate:modelValue":t[2]||(t[2]=function(e){return w.formLog.name=e}),onInput:t[3]||(t[3]=function(){w.formLog.emptyName=!1,w.formLog.noSuchName=!1}),class:"mainInput popUp__input",type:"text",name:"name",id:"name",placeholder:"Name"},null,544),[[r["B"],w.formLog.name,void 0,{trim:!0}]]),Object(r["g"])("span",null,Object(r["z"])(w.formLog.emptyName?"Enter a name":w.formLog.noSuchName?"No such user":""),1),Object(r["g"])("label",{class:["popUp__label",{"popUp__label--invalid":w.formLog.emptyPassword||w.formLog.wrongPassword}],for:"password"},null,2),Object(r["F"])(Object(r["g"])("input",{onKeypress:t[4]||(t[4]=Object(r["G"])(Object(r["H"])((function(){}),["prevent"]),["space"])),"onUpdate:modelValue":t[5]||(t[5]=function(e){return w.formLog.password=e}),onInput:t[6]||(t[6]=function(){w.formLog.emptyPassword=!1,w.formLog.wrongPassword=!1}),class:"mainInput popUp__input",type:"password",name:"password",id:"password",placeholder:"Password"},null,544),[[r["B"],w.formLog.password,void 0,{trim:!0}]]),Object(r["g"])("span",null,Object(r["z"])(w.formLog.emptyPassword?"Enter a password":w.formLog.wrongPassword?"Wrong password":""),1),m],32)]))]),e.authorizedUser?Object(r["e"])("",!0):(Object(r["q"])(),Object(r["d"])("div",O,[v,Object(r["g"])("form",{action:"",method:"POST",onsubmit:"return false;",onSubmit:t[20]||(t[20]=Object(r["H"])((function(){return j.validateRegistrationData.apply(j,arguments)}),["prevent"]))},[Object(r["g"])("label",{class:["popUp__label",{"popUp__label--invalid":w.formReg.emptyName||w.formReg.nameExist||w.formReg.nameLenMin||w.formReg.nameLenMax}],for:"regName"},null,2),Object(r["F"])(Object(r["g"])("input",{"onUpdate:modelValue":t[12]||(t[12]=function(e){return w.formReg.name=e}),onInput:t[13]||(t[13]=function(){w.formReg.emptyName=!1,w.formReg.nameExist=!1,w.formReg.nameLenMin=!1,w.formReg.nameLenMax=!1}),class:"mainInput popUp__input",type:"text",name:"name",id:"regName",placeholder:"Name"},null,544),[[r["B"],w.formReg.name,void 0,{trim:!0}]]),Object(r["g"])("span",null,Object(r["z"])(w.formReg.emptyName?"Enter a name":w.formReg.nameLenMin?"At least 3 characters":w.formReg.nameLenMax?"To long name":w.formReg.nameExist?"Already exist":""),1),Object(r["g"])("label",{class:["popUp__label",{"popUp__label--invalid":w.formReg.emptyPassword||w.formReg.passwordLen}],for:"regPassword"},null,2),Object(r["F"])(Object(r["g"])("input",{onKeypress:t[14]||(t[14]=Object(r["G"])(Object(r["H"])((function(){}),["prevent"]),["space"])),"onUpdate:modelValue":t[15]||(t[15]=function(e){return w.formReg.password=e}),onInput:t[16]||(t[16]=function(){w.formReg.emptyPassword=!1,w.formReg.passwordLen=!1}),class:"mainInput popUp__input",type:"password",name:"password",id:"regPassword",placeholder:"Password"},null,544),[[r["B"],w.formReg.password,void 0,{trim:!0}]]),Object(r["g"])("span",null,Object(r["z"])(w.formReg.emptyPassword?"Enter a password":w.formReg.passwordLen?"At least 8 characters":""),1),Object(r["g"])("label",{class:["popUp__label",{"popUp__label--invalid":w.formReg.rePasswordCheck}],for:"regRePassword"},null,2),Object(r["F"])(Object(r["g"])("input",{onKeypress:t[17]||(t[17]=Object(r["G"])(Object(r["H"])((function(){}),["prevent"]),["space"])),"onUpdate:modelValue":t[18]||(t[18]=function(e){return w.formReg.rePassword=e}),onInput:t[19]||(t[19]=function(){w.formReg.rePasswordCheck=!1}),class:"mainInput popUp__input",type:"password",name:"rePassword",id:"regRePassword",placeholder:"Password again"},null,544),[[r["B"],w.formReg.rePassword,void 0,{trim:!0}]]),Object(r["g"])("span",null,Object(r["z"])(w.formReg.rePasswordCheck?"Wrong password repeat":""),1),_],32)]))])])})),j=(n("4de4"),n("7db0"),n("4160"),n("d3b7"),n("159b"),n("5530")),x=(n("c1df"),n("cee4"),n("5502")),P=n("8575"),U=Object(r["I"])("data-v-56052e96");Object(r["t"])("data-v-56052e96");var y={class:"FileInput"},R=Object(r["g"])("span",{class:"FileInput__text"},"No file chosen",-1);Object(r["r"])();var L=U((function(e,t,n,o,a,s){return Object(r["q"])(),Object(r["d"])("div",y,[Object(r["g"])("input",{onChange:t[1]||(t[1]=function(){return s.changeText.apply(s,arguments)}),class:"FileInput__input",type:"file",name:"photo",accept:"image/*"},null,32),Object(r["g"])("button",{onClick:t[2]||(t[2]=Object(r["H"])((function(){return s.chouseFile.apply(s,arguments)}),["prevent"])),class:"FileInput__button"},"Choose a file"),R])})),E=(n("ac1f"),n("466d"),{data:function(){return{input:"",button:"",text:""}},methods:{chouseFile:function(){this.input.click()},changeText:function(){this.text.innerText=this.input.value.match(/[\/\\]([\w\d\s\.\-\(\)]+)$/)[1]}},mounted:function(){var e=this;this.$nextTick((function(){e.input=document.querySelector(".FileInput__input"),e.button=document.querySelector(".FileInput__button"),e.text=document.querySelector(".FileInput__text")}))}});n("c772");E.render=L,E.__scopeId="data-v-56052e96";var I=E,N={name:"Auth",components:{FileInput:I},data:function(){return{BACKEND_DOMAIN:P["a"],formReg:{name:"",password:"",rePassword:"",emptyPassword:!1,emptyName:!1,rePasswordCheck:!1,nameExist:!1,nameLenMin:!1,nameLenMax:!1,passwordLen:!1},formLog:{name:"",password:"",emptyPassword:!1,emptyName:!1,noSuchName:!1,wrongPassword:!1},formProfile:{name:"",emptyName:!1,nameExist:!1,nameLenMin:!1,nameLenMax:!1}}},computed:Object(j["a"])(Object(j["a"])({},Object(x["d"])(["authorizedUser","contacts"])),{},{authorizedUserObj:function(){var e=this,t=this.contacts.find((function(t){return t.name==e.authorizedUser}));return t||{notifications:[]}}}),methods:Object(j["a"])(Object(j["a"])({},Object(x["b"])(["SET_NEW_CONTACT","LOG_OUT","LOG_IN","GET_CHATS","CHANGE_PROFILE"])),{},{hidePopUp:function(){this.$parent.$parent.hidePopUp()},getIndexByUserName:function(e){var t=null;return this.contacts.forEach((function(n,r){n.name===e&&(t=r)})),t},logIn:function(e){var t=this,n=this.formLog.name,r=this.formLog.password,o={name:n,password:r,index:e};return new Promise((function(e){t.LOG_IN(o).then((function(t){e(t)}))}))},sendRegistrationData:function(){var e=this.formReg.password,t=this.formReg.name,n={password:e,name:t};this.SET_NEW_CONTACT(n),this.formReg.name="",this.formReg.password="",this.formReg.rePassword=""},isNameAndPassEmpty:function(e,t,n){var r=!0;return null===t&&(t=!0,r=!1),""!=e&&""!=t?(n.emptyName=!1,r&&(n.emptyPassword=!1),!1):(n.emptyName=""==e,r&&(n.emptyPassword=""==t),!0)},isUserExist:function(e){var t=this.contacts.filter((function(t){return t.name==e.name}));return t.length?(e.nameExist=!0,!0):(e.nameExist=!1,!1)},namePasswordLenOk:function(e,t,n){var r=!0;return null===t&&(t="********",r=!1),e.length>=3&&t.length>=8&&e.length<=10?(r&&(n.passwordLen=!1),n.nameLenMin=!1,!0):(e.length<3?n.nameLenMin=!0:n.nameLenMin=!1,e.length>15?n.nameLenMax=!0:n.nameLenMax=!1,r&&(t.length<8?n.passwordLen=!0:n.passwordLen=!1),!1)},validateRegistrationData:function(){var e=this.formReg.name,t=this.formReg.password,n=this.formReg.rePassword;return!this.isNameAndPassEmpty(e,t,this.formReg)&&(!!this.namePasswordLenOk(e,t,this.formReg)&&(t!=n?(this.formReg.rePasswordCheck=!0,!1):(this.formReg.rePasswordCheck=!1,!this.isUserExist(this.formReg)&&(this.sendRegistrationData(),this.hidePopUp(),void this.$router.push("/")))))},validatelogIn:function(e){var t=this.formLog.name,n=this.formLog.password;if(this.isNameAndPassEmpty(t,n,this.formLog))return!1;var r=this.getIndexByUserName(t);if(null===r)return this.formLog.noSuchName=!0,!1;this.formLog.noSuchName=!1,this.logIn(r).then(function(e){""==e.data?this.formLog.wrongPassword=!0:(this.formLog.wrongPassword=!1,this.formReg.name="",this.formReg.password="",this.GET_CHATS(),this.hidePopUp(),this.$router.push("/"))}.bind(this))},validateChanges:function(e){var t=this.formProfile.name;if(t&&!this.namePasswordLenOk(t,null,this.formProfile))return!1;if(this.isUserExist(this.formProfile))return!1;var n=e.target;this.sendChanges(n),this.hidePopUp()},sendChanges:function(e){var t=new FormData(e),n=this.authorizedUser,r=this.formProfile.name;this.CHANGE_PROFILE({changes:t,oldUsername:n,newUsername:r})},logOut:function(e){var t=this.getIndexByUserName(this.authorizedUser),n={index:t};this.LOG_OUT(n),this.hidePopUp(),this.$router.push("/")}})};n("33d2");N.render=w,N.__scopeId="data-v-58c57db6";t["default"]=N},abba:function(e,t,n){},ac1f:function(e,t,n){"use strict";var r=n("23e7"),o=n("9263");r({target:"RegExp",proto:!0,forced:/./.exec!==o},{exec:o})},ad6d:function(e,t,n){"use strict";var r=n("825a");e.exports=function(){var e=r(this),t="";return e.global&&(t+="g"),e.ignoreCase&&(t+="i"),e.multiline&&(t+="m"),e.dotAll&&(t+="s"),e.unicode&&(t+="u"),e.sticky&&(t+="y"),t}},c772:function(e,t,n){"use strict";n("ea66")},d784:function(e,t,n){"use strict";n("ac1f");var r=n("6eeb"),o=n("d039"),a=n("b622"),s=n("9263"),i=n("9112"),c=a("species"),u=!o((function(){var e=/./;return e.exec=function(){var e=[];return e.groups={a:"7"},e},"7"!=="".replace(e,"$<a>")})),l=function(){return"$0"==="a".replace(/./,"$0")}(),p=a("replace"),m=function(){return!!/./[p]&&""===/./[p]("a","$0")}(),d=!o((function(){var e=/(?:)/,t=e.exec;e.exec=function(){return t.apply(this,arguments)};var n="ab".split(e);return 2!==n.length||"a"!==n[0]||"b"!==n[1]}));e.exports=function(e,t,n,p){var f=a(e),g=!o((function(){var t={};return t[f]=function(){return 7},7!=""[e](t)})),h=g&&!o((function(){var t=!1,n=/a/;return"split"===e&&(n={},n.constructor={},n.constructor[c]=function(){return n},n.flags="",n[f]=/./[f]),n.exec=function(){return t=!0,null},n[f](""),!t}));if(!g||!h||"replace"===e&&(!u||!l||m)||"split"===e&&!d){var b=/./[f],O=n(f,""[e],(function(e,t,n,r,o){return t.exec===s?g&&!o?{done:!0,value:b.call(t,n,r)}:{done:!0,value:e.call(n,t,r)}:{done:!1}}),{REPLACE_KEEPS_$0:l,REGEXP_REPLACE_SUBSTITUTES_UNDEFINED_CAPTURE:m}),v=O[0],_=O[1];r(String.prototype,e,v),r(RegExp.prototype,f,2==t?function(e,t){return _.call(e,this,t)}:function(e){return _.call(e,this)})}p&&i(RegExp.prototype[f],"sham",!0)}},ea66:function(e,t,n){}}]);
//# sourceMappingURL=auth.4a53a8b5.js.map